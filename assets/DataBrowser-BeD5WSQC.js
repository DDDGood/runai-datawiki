import{u as M,j as N,o as T,a as s,c as a,b as e,t as r,k as O,v as P,F as h,r as k,l as $,g as y,m as c,n as R,h as q,i as j,p as z}from"./index-vk6eD9g1.js";const E={class:"flex items-center justify-between mb-6"},G={class:"text-2xl font-bold flex items-center gap-2"},J={class:"text-gray-500 mt-1"},U={class:"flex items-center gap-4"},A={class:"text-sm text-gray-500"},H={class:"bg-white rounded-lg p-4 mb-4 shadow-sm"},K={class:"bg-white rounded-lg shadow-sm overflow-hidden"},Q={key:0,class:"p-8 text-center text-gray-500"},W={key:1,class:"p-8 text-center text-gray-500"},X={key:2,class:"w-full"},Y={class:"bg-gray-50 border-b"},Z=["onClick"],ee={class:"flex items-center gap-1"},te={key:0,class:"text-blue-500"},se={class:"divide-y"},ae=["onClick"],oe={key:0,class:"font-mono text-blue-600"},le={key:1,class:"text-gray-400"},ne={class:"px-4 py-3 text-right"},re=["onClick"],ue={key:3,class:"px-4 py-3 border-t flex items-center justify-between"},ce={class:"text-sm text-gray-500"},ie={class:"flex gap-2"},de=["disabled"],ve=["disabled"],ge={__name:"DataBrowser",setup(pe){const w=R(),B=q(),D=M(),x=y(()=>w.params.type),i=y(()=>D.getDataTypeConfig(x.value)),C=c([]),m=c(!0),u=c(1),b=c(20),d=c(""),v=c("ID"),p=c("asc"),F=async()=>{m.value=!0,C.value=await D.loadData(x.value),m.value=!1},g=y(()=>{let o=[...C.value];if(d.value){const n=d.value.toLowerCase();o=o.filter(t=>i.value?.searchFields.some(l=>{const _=t[l];return typeof _=="string"&&_.toLowerCase().includes(n)}))}return o.sort((n,t)=>{const l=n[v.value]||"",_=t[v.value]||"",V=String(l).localeCompare(String(_));return p.value==="asc"?V:-V}),o}),I=y(()=>{const o=(u.value-1)*b.value;return g.value.slice(o,o+b.value)}),f=y(()=>Math.ceil(g.value.length/b.value)),L=o=>{v.value===o?p.value=p.value==="asc"?"desc":"asc":(v.value=o,p.value="asc")},S=o=>{B.push({name:"DataDetail",params:{type:x.value,id:o.ID}})};return N(()=>w.params.type,()=>{u.value=1,d.value="",F()},{immediate:!0}),T(()=>{F()}),(o,n)=>(s(),a("div",null,[e("div",E,[e("div",null,[e("h1",G,[e("span",null,r(i.value?.icon),1),e("span",null,r(i.value?.name),1)]),e("p",J,r(i.value?.description),1)]),e("div",U,[e("span",A," 共 "+r(g.value.length)+" 筆資料 ",1)])]),e("div",H,[O(e("input",{"onUpdate:modelValue":n[0]||(n[0]=t=>d.value=t),type:"text",placeholder:"搜尋...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[P,d.value]])]),e("div",K,[m.value?(s(),a("div",Q," 載入中... ")):g.value.length===0?(s(),a("div",W," 沒有找到符合條件的資料 ")):(s(),a("table",X,[e("thead",Y,[e("tr",null,[(s(!0),a(h,null,k(i.value?.primaryFields,t=>(s(),a("th",{key:t,class:"px-4 py-3 text-left text-sm font-medium text-gray-600 cursor-pointer hover:bg-gray-100",onClick:l=>L(t)},[e("div",ee,[j(r(t)+" ",1),v.value===t?(s(),a("span",te,r(p.value==="asc"?"↑":"↓"),1)):$("",!0)])],8,Z))),128)),n[3]||(n[3]=e("th",{class:"px-4 py-3 text-right text-sm font-medium text-gray-600"}," 操作 ",-1))])]),e("tbody",se,[(s(!0),a(h,null,k(I.value,t=>(s(),a("tr",{key:t.ID,class:"hover:bg-gray-50 cursor-pointer",onClick:l=>S(t)},[(s(!0),a(h,null,k(i.value?.primaryFields,l=>(s(),a("td",{key:l,class:"px-4 py-3 text-sm"},[l==="ID"?(s(),a("span",oe,r(t[l]),1)):typeof t[l]=="object"?(s(),a("span",le,r(JSON.stringify(t[l])),1)):(s(),a(h,{key:2},[j(r(t[l]??"-"),1)],64))]))),128)),e("td",ne,[e("button",{class:"text-blue-600 hover:text-blue-800 text-sm",onClick:z(l=>S(t),["stop"])}," 查看 ",8,re)])],8,ae))),128))])])),f.value>1?(s(),a("div",ue,[e("div",ce," 第 "+r(u.value)+" / "+r(f.value)+" 頁 ",1),e("div",ie,[e("button",{disabled:u.value===1,class:"px-3 py-1 border rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",onClick:n[1]||(n[1]=t=>u.value--)}," 上一頁 ",8,de),e("button",{disabled:u.value===f.value,class:"px-3 py-1 border rounded text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",onClick:n[2]||(n[2]=t=>u.value++)}," 下一頁 ",8,ve)])])):$("",!0)])]))}};export{ge as default};
